10 DIM X(16)
20 ONBRK GOTO 330
30 WIDTH 40
40 LOADM"BSCTOOL
50 INPUT "INPUT FILENAME";I$
60 INPUT "OUTPUT FILENAME";O$
70 FOR I=0 TO 15
80 PRINT "COLOR IN PALETTE POSITION";I;"MOVE TO POSITION";
90 INPUT X(I)
100 NEXT I
110 HSCREEN 2
120 EXEC:R:L:I$
130 POKE &HFFD9,0
140 FOR I=0 TO 15
150 C(I)=PEEK(&HFFB0+I) AND &H3F
160 NEXT I
170 FOR I=0 TO 15
180 PALETTE I,C(X(I))
190 NEXT I
200 B=&H60000
210 FOR I=B TO B+32000
220 V=BUTTON(I)
230 IF V=17 THEN 310
240 LN=(V AND &HF0) // 16
250 LN=X(LN)
260 RN=(V AND &H0F)
270 RN=X(RN)
280 V=(16*LN)+RN
290 LPOKE I,V
300 NEXT I
310 POKE &HFFD8,0
320 EXEC:R:S:O$
330 POKE &HFFD8,0
